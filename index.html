<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎄 Lotteria di Natale 2025 - Genoa CFC</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#002147">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Fonts Natalizi -->
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@400;700&family=Dancing+Script:wght@400;500;600;700&family=Montserrat:wght@300;400;600;700;800&family=Fredoka+One:wght@400&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎄</text></svg>">
    
    <style>
        /* === STILE PREMIUM LOTTERIA GENOA === */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #001122 0%, #002147 20%, #1a4d72 50%, #002147 80%, #001122 100%);
            background-attachment: fixed;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Effetto neve */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="1" fill="white" opacity="0.3"/><circle cx="30" cy="30" r="1.5" fill="white" opacity="0.4"/><circle cx="60" cy="20" r="1" fill="white" opacity="0.5"/><circle cx="80" cy="60" r="2" fill="white" opacity="0.3"/><circle cx="40" cy="80" r="1" fill="white" opacity="0.6"/></svg>') repeat;
            animation: snowfall 20s linear infinite;
            pointer-events: none;
            z-index: 1;
        }
        
        @keyframes snowfall {
            0% { transform: translateY(-100vh); }
            100% { transform: translateY(100vh); }
        }
        
        /* Header Premium */
        .lottery-header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .lottery-title {
            font-family: 'Mountains of Christmas', 'Dancing Script', cursive;
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #c8102e, #ff6b6b, #ffd700, #c8102e);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: christmasGlow 4s ease-in-out infinite;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
            z-index: 2;
        }
        
        .lottery-title::before {
            content: '⚽';
            position: absolute;
            left: -60px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2.5rem;
            animation: bounce 2s infinite;
        }
        
        .lottery-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 4px;
            background: linear-gradient(90deg, transparent, #ffd700, #c8102e, #ffd700, transparent);
            border-radius: 2px;
            animation: shimmer 3s ease-in-out infinite;
        }
        
        @keyframes christmasGlow {
            0%, 100% { background-position: 0% 50%; filter: drop-shadow(0 0 20px #c8102e); }
            25% { background-position: 50% 0%; filter: drop-shadow(0 0 25px #ffd700); }
            50% { background-position: 100% 50%; filter: drop-shadow(0 0 20px #ff6b6b); }
            75% { background-position: 50% 100%; filter: drop-shadow(0 0 25px #c8102e); }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(-50%); }
            40% { transform: translateY(-70%); }
            60% { transform: translateY(-60%); }
        }
        
        @keyframes shimmer {
            0% { opacity: 0.5; transform: translateX(-50%) scaleX(0.8); }
            50% { opacity: 1; transform: translateX(-50%) scaleX(1.2); }
            100% { opacity: 0.5; transform: translateX(-50%) scaleX(0.8); }
        }
        
        .lottery-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 30px;
            position: relative;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .lottery-subtitle::before {
            content: '🎄';
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .lottery-subtitle::after {
            content: '🎄';
            margin-left: 10px;
            font-size: 1.2rem;
        }
        
        /* Locandina */
        .locandina-container {
            margin: 30px auto;
            max-width: 600px;
            position: relative;
            z-index: 2;
            padding: 20px;
            border-radius: 30px;
            background: 
                linear-gradient(145deg, rgba(255,215,0,0.3), rgba(255,215,0,0.1)),
                linear-gradient(45deg, #ffd700, #ffed4e, #ffd700);
            border: 5px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 30px 60px rgba(0,0,0,0.5),
                0 0 50px rgba(255,215,0,0.6),
                inset 0 2px 0 rgba(255,255,255,0.3),
                inset 0 -2px 0 rgba(0,0,0,0.1);
            animation: goldGlow 3s ease-in-out infinite;
        }
        
        .locandina-container::before {
            content: '';
            position: absolute;
            inset: 15px;
            border-radius: 20px;
            background: linear-gradient(135deg, 
                rgba(255,215,0,0.4) 0%, 
                rgba(255,215,0,0.1) 25%, 
                rgba(255,215,0,0.4) 50%, 
                rgba(255,215,0,0.1) 75%, 
                rgba(255,215,0,0.4) 100%);
            z-index: -1;
            animation: shimmerGold 4s linear infinite;
        }
        
        .locandina-container::after {
            content: '👑';
            position: absolute;
            top: -20px;
            right: 30px;
            font-size: 2.5rem;
            background: radial-gradient(circle, #ffd700, #ffed4e);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 10px 25px rgba(255,215,0,0.6),
                0 0 30px rgba(255,215,0,0.4);
            animation: crownFloat 2.5s ease-in-out infinite;
            border: 3px solid #fff;
        }
        
        @keyframes goldGlow {
            0%, 100% { 
                box-shadow: 
                    0 30px 60px rgba(0,0,0,0.5),
                    0 0 50px rgba(255,215,0,0.6),
                    inset 0 2px 0 rgba(255,255,255,0.3);
            }
            50% { 
                box-shadow: 
                    0 35px 70px rgba(0,0,0,0.6),
                    0 0 70px rgba(255,215,0,0.8),
                    inset 0 3px 0 rgba(255,255,255,0.4);
            }
        }
        
        @keyframes shimmerGold {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        @keyframes crownFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-8px) rotate(2deg); }
            66% { transform: translateY(-4px) rotate(-1deg); }
        }
        
        .locandina-img {
            width: 100%;
            height: auto;
            border-radius: 15px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.3),
                0 0 30px rgba(200,16,46,0.2);
            transition: transform 0.3s ease;
        }
        
        .locandina-img:hover {
            transform: scale(1.02);
            box-shadow: 
                0 25px 50px rgba(0,0,0,0.4),
                0 0 40px rgba(255,215,0,0.3);
        }
        
        .countdown-container {
            background: rgba(200,16,46,0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            max-width: 500px;
            border: 2px solid rgba(200,16,46,0.3);
        }
        
        .countdown-timer {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ff6b6b;
        }
        
        /* Container Principale */
        .lottery-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Info Panel con Decorazioni */
        .info-panel {
            background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 40px;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255,215,0,0.2);
            box-shadow: 
                0 15px 35px rgba(0,0,0,0.3),
                0 0 20px rgba(255,215,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.2);
            position: relative;
        }
        
        .info-panel h2 {
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 25px;
            font-size: 2rem;
        }
        
        .prizes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .prize-card {
            background: linear-gradient(135deg, #c8102e, #a50d26);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(200,16,46,0.3);
            transition: transform 0.3s ease;
        }
        
        .prize-card:hover {
            transform: translateY(-5px);
        }
        
        .prize-place {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
        }
        
        .prize-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .prize-value {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        /* Griglia Numeri */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(85px, 1fr));
            gap: 15px;
            margin: 30px 0;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 20px;
        }
        
        .number-box {
            aspect-ratio: 1;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Fredoka One', 'Montserrat', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
        }
        
        .number-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,215,0,0.1), transparent);
            transform: rotate(-45deg);
            transition: transform 0.6s;
            opacity: 0;
        }
        
        .number-box:hover {
            transform: scale(1.1);
            border-color: #ffd700;
            box-shadow: 0 12px 30px rgba(255,215,0,0.4);
            z-index: 10;
            position: relative;
        }
        
        .number-box:active {
            transform: scale(0.95);
        }
        
        .number-box.available:hover {
            background: linear-gradient(145deg, rgba(34,197,94,0.4), rgba(22,163,74,0.2));
            color: #34d399;
        }
        
        .number-box.sold:hover {
            transform: scale(1);
            cursor: not-allowed;
            box-shadow: 0 8px 20px rgba(120,113,108,0.3);
        }
        
        .number-box.available {
            background: linear-gradient(145deg, rgba(34,197,94,0.2), rgba(22,163,74,0.1));
            border-color: #10b981;
            color: #10b981;
            box-shadow: 
                0 8px 25px rgba(16,185,129,0.2),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }
        
        .number-box.available:hover::before {
            opacity: 1;
            transform: rotate(-45deg) translate(100%, 100%);
        }
        
        .number-box.selected {
            background: linear-gradient(145deg, #c8102e, #dc2626, #b91c1c);
            border-color: #ffd700;
            color: white;
            box-shadow: 
                0 12px 30px rgba(200,16,46,0.6),
                0 0 30px rgba(255,215,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.2);
            animation: christmasPulse 2s infinite;
            transform: scale(1.05);
        }
        
        .number-box.selected::after {
            content: '⭐';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 1.2rem;
            animation: starTwinkle 1.5s infinite;
        }
        
        .number-box.sold {
            background: linear-gradient(145deg, rgba(120,113,108,0.4), rgba(87,83,78,0.2));
            border-color: #78716c;
            color: #a8a29e;
            cursor: not-allowed;
            position: relative;
            opacity: 0.7;
        }
        
        .number-box.sold::before {
            content: '❄️';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1rem;
            opacity: 0.6;
        }
        
        /* Stile per numeri disabilitati (lotteria conclusa) */
        .number-box.disabled {
            cursor: not-allowed !important;
            pointer-events: none;
            opacity: 0.5;
            filter: grayscale(70%);
        }
        
        .number-box.disabled::after {
            content: '🔒';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.8rem;
            opacity: 0.7;
        }
        
        @keyframes christmasPulse {
            0%, 100% { 
                box-shadow: 
                    0 12px 30px rgba(200,16,46,0.6),
                    0 0 30px rgba(255,215,0,0.4);
            }
            50% { 
                box-shadow: 
                    0 15px 35px rgba(200,16,46,0.8),
                    0 0 40px rgba(255,215,0,0.6);
            }
        }
        
        @keyframes starTwinkle {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.3) rotate(180deg); opacity: 0.8; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Pannello Selezione */
        .selection-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
            text-align: center;
        }
        
        .selected-numbers {
            font-size: 1.2rem;
            margin-bottom: 15px;
        }
        
        .total-price {
            font-size: 2rem;
            font-weight: 800;
            color: #c8102e;
            margin-bottom: 20px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-premium {
            background: linear-gradient(135deg, #c8102e, #a50d26);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(200,16,46,0.3);
            min-width: 150px;
        }
        
        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(200,16,46,0.4);
            background: linear-gradient(135deg, #e91e63, #c8102e);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }
        
        /* Lista Acquisti */
        .purchases-section {
            background: linear-gradient(135deg, 
                rgba(0,33,71,0.4) 0%,
                rgba(0,33,71,0.2) 50%,
                rgba(0,33,71,0.4) 100%);
            border-radius: 25px;
            padding: 30px;
            margin: 30px 0;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(200,16,46,0.2);
            box-shadow: 
                0 15px 40px rgba(0,33,71,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position: relative;
        }
        
        .purchases-section h2 {
            color: #ffd700;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
        }
        
        .purchases-section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, #c8102e, #ffd700, #c8102e);
            border-radius: 2px;
        }
        
        .purchase-item {
            background: linear-gradient(135deg, 
                rgba(0,33,71,0.9) 0%,
                rgba(0,33,71,0.7) 50%,
                rgba(0,33,71,0.9) 100%);
            border: 2px solid rgba(200,16,46,0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 
                0 8px 25px rgba(0,33,71,0.3),
                0 0 20px rgba(200,16,46,0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .purchase-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(200,16,46,0.1) 50%, 
                transparent 100%);
            animation: shimmer 3s infinite;
        }
        
        .purchase-item:hover {
            transform: translateY(-3px);
            border-color: rgba(200,16,46,0.6);
            box-shadow: 
                0 12px 35px rgba(0,33,71,0.4),
                0 0 30px rgba(200,16,46,0.2);
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .lottery-title {
                font-size: 2rem;
            }
            
            .lottery-title::before {
                left: -45px;
                font-size: 2rem;
            }
            
            .lottery-title::after {
                width: 150px;
            }
            
            .locandina-container {
                margin: 30px 15px;
                padding: 15px;
                border-radius: 25px;
            }
            
            .locandina-container::before {
                inset: 12px;
            }
            
            .locandina-container::after {
                top: -12px;
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                gap: 12px;
                padding: 0 15px;
            }
            
            .number-box {
                font-size: 1.2rem;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-premium {
                width: 100%;
                max-width: 300px;
            }
            
            /* Lista Acquisti Mobile */
            .purchases-section {
                padding: 20px 15px;
                margin: 20px 10px;
                border-radius: 20px;
            }
            
            .purchases-section h2 {
                font-size: 1.4rem;
                margin-bottom: 20px;
            }
            
            .purchase-item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
                margin-bottom: 12px;
                border-radius: 12px;
            }
            
            .purchase-item > div:first-child {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .purchase-item > div:last-child {
                width: 100%;
                text-align: right;
            }
            
            /* Carosello responsive tablet */
            .carousel-title {
                font-size: 2rem;
                margin: 20px 0 15px 0;
                letter-spacing: 1.5px;
            }
            
            .carousel-subtitle {
                font-size: 1rem;
                margin-bottom: 20px;
            }
            
            .carousel-container {
                height: 380px;
            }
            
            .carousel-slide {
                padding: 25px;
            }
            
            .prize-image-carousel {
                padding-right: 20px;
            }
            
            .prize-details-carousel {
                padding-left: 20px;
            }
            
            .prize-rank-carousel {
                font-size: 1.5rem;
            }
            
            .prize-name-carousel {
                font-size: 1.3rem;
            }
            
            .prize-model-carousel {
                font-size: 1rem;
            }
            
            .prize-description-carousel {
                font-size: 0.95rem;
            }
            
            .prize-price-carousel {
                font-size: 1.7rem;
                padding: 8px 16px;
            }
        }
        
        @media (max-width: 480px) {
            .lottery-title {
                font-size: 1.6rem;
                padding: 0 10px;
            }
            
            .lottery-title::before {
                left: -35px;
                font-size: 1.8rem;
            }
            
            .lottery-title::after {
                width: 120px;
                height: 2px;
            }
            
            .lottery-subtitle {
                font-size: 0.9rem;
                letter-spacing: 1px;
            }
            
            .lottery-subtitle::before,
            .lottery-subtitle::after {
                font-size: 1.1rem;
            }
            
            .locandina-container {
                margin: 20px 10px;
                padding: 12px;
                border-radius: 20px;
            }
            
            .locandina-container::before {
                inset: 10px;
                border-radius: 15px;
            }
            
            .locandina-container::after {
                top: -10px;
                width: 35px;
                height: 35px;
                font-size: 1.3rem;
            }
            
            .locandina-img {
                border-radius: 12px;
            }
            
            .info-panel {
                margin: 15px 10px;
                padding: 20px 15px;
            }
            
            .info-panel h2 {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(7, 1fr);
                gap: 10px;
                padding: 0 10px;
                margin: 20px 0;
            }
            
            .number-box {
                font-size: 1.1rem;
                min-height: 45px;
                border-radius: 12px;
                border-width: 2px;
                font-weight: 600;
            }
            
            /* Miglioramenti specifici per numeri venduti su mobile */
            .number-box.sold {
                font-size: 1rem;
                opacity: 0.7;
            }
            
            /* Numeri selezionati più visibili su mobile */
            .number-box.selected {
                transform: scale(0.95);
                font-size: 1rem;
                font-weight: 700;
            }
            
            .selection-panel {
                margin: 15px 10px;
                padding: 15px;
            }
            
            .purchases-section {
                padding: 15px 10px;
                margin: 15px 5px;
            }
            
            .purchases-section h2 {
                font-size: 1.2rem;
            }
            
            .purchase-item {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            /* Carosello responsive mobile */
            .prizes-carousel {
                margin: 20px 10px;
                border-radius: 20px;
                border: 2px solid #ffd700;
            }
            
            .carousel-title {
                font-size: 1.6rem;
                margin: 15px 0 10px 0;
                letter-spacing: 1px;
                padding: 0 15px;
            }
            
            .carousel-subtitle {
                font-size: 0.9rem;
                margin-bottom: 15px;
                padding: 0 15px;
            }
            
            .carousel-container {
                height: 500px;
            }
            
            .carousel-slide {
                flex-direction: column;
                padding: 20px 15px;
                text-align: center;
                justify-content: flex-start;
            }
            
            .prize-image-carousel {
                max-width: 100%;
                padding-right: 0;
                margin-bottom: 20px;
            }
            
            .prize-image-carousel img {
                max-height: 200px;
                border-radius: 12px;
            }
            
            .prize-details-carousel {
                max-width: 100%;
                padding-left: 0;
            }
            
            .prize-rank-carousel {
                font-size: 1.4rem;
                margin-bottom: 10px;
            }
            
            .prize-name-carousel {
                font-size: 1.2rem;
                margin-bottom: 8px;
            }
            
            .prize-model-carousel {
                font-size: 1rem;
                margin-bottom: 10px;
            }
            
            .prize-description-carousel {
                font-size: 0.9rem;
                margin-bottom: 15px;
                line-height: 1.5;
            }
            
            .prize-price-carousel {
                font-size: 1.5rem;
                padding: 8px 15px;
                border-radius: 12px;
            }
            
            .carousel-controls {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .carousel-prev {
                left: 15px;
            }
            
            .carousel-next {
                right: 15px;
            }
            
            .carousel-indicators {
                padding: 20px 0;
                gap: 10px;
            }
            
            .carousel-dot {
                width: 12px;
                height: 12px;
            }
        }
        
        /* Animazioni */
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Animazione Pulse per vincitori */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); box-shadow: 0 0 40px rgba(255,215,0,0.6); }
            100% { transform: scale(1); }
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            z-index: 10000;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }
        
        .toast.success {
            border-left: 4px solid #4caf50;
        }
        
        .toast.error {
            border-left: 4px solid #f44336;
        }
        
        .toast.info {
            border-left: 4px solid #2196f3;
        }
        
        /* === GRIGLIA PREMI ORIZZONTALE === */
        .prize-horizontal, .prize-card {
            display: flex;
            margin-bottom: 25px;
        }
        
        .prize-image-section {
            flex: 0 0 320px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 25px;
        }
        
        .prize-content-section {
            flex: 1;
            padding: 35px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Animazioni moderne */
        @keyframes shimmer {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(200%) rotate(45deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.4; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.3); }
            50% { box-shadow: 0 0 40px rgba(255,215,0,0.6), 0 0 60px rgba(255,215,0,0.4); }
        }

        .prize-gold:hover { animation: glow 2s ease-in-out infinite; }
        
        @media (max-width: 768px) {
            .prize-horizontal, .prize-card {
                flex-direction: column !important;
                margin-bottom: 30px !important;
                min-height: auto !important;
                border-radius: 20px !important;
            }
            
            .prize-image-section {
                flex: none !important;
                width: 100% !important;
                text-align: center !important;
                padding: 25px 20px !important;
                min-height: 220px !important;
                border-radius: 20px 20px 0 0 !important;
            }
            
            .prize-content-section {
                padding: 30px 25px !important;
            }
            
            .prize-horizontal img, .prize-card img {
                max-width: 220px !important;
                max-height: 170px !important;
            }

            /* Mobile-specific adjustments */
            .prizes-section {
                margin: 50px auto !important;
                padding: 0 20px !important;
            }

            .section-header h2 {
                font-size: 2.3rem !important;
                letter-spacing: 2px !important;
            }

            .section-header p {
                font-size: 1.15rem !important;
                margin: 20px 0 !important;
            }

            .prize-content-section div:nth-child(5) {
                font-size: 1.9rem !important;
                padding: 14px 20px !important;
                text-align: center !important;
                margin: 0 auto !important;
            }

            /* Badge positioning for mobile */
            .prize-card > div:nth-child(3) {
                top: 10px !important;
                left: 10px !important;
                font-size: 0.85rem !important;
                padding: 10px 16px !important;
            }
        }
        
        @media (max-width: 480px) {
            .prize-image-section {
                padding: 20px 15px !important;
                min-height: 180px !important;
            }
            
            .prize-content-section {
                padding: 25px 20px !important;
            }
            
            .prize-horizontal img, .prize-card img {
                max-width: 180px !important;
                max-height: 140px !important;
            }

            .section-header h2 {
                font-size: 1.9rem !important;
                letter-spacing: 1px !important;
                line-height: 1.2 !important;
            }

            .section-header p {
                font-size: 1.05rem !important;
                padding: 0 10px !important;
            }

            .prizes-section {
                margin: 40px auto !important;
                padding: 0 15px !important;
            }

            .prizes-container {
                gap: 25px !important;
            }

            /* Titoli premi più piccoli su mobile */
            .prize-content-section > div:first-child {
                font-size: 1.6rem !important;
            }

            /* Sottotitoli più leggibili */
            .prize-content-section > div:nth-child(3) {
                font-size: 1.1rem !important;
            }

            /* Descrizioni ottimizzate */
            .prize-content-section > div:nth-child(4) {
                font-size: 0.95rem !important;
                line-height: 1.6 !important;
            }

            /* Prezzi responsive */
            .prize-content-section div:nth-child(5) {
                font-size: 1.6rem !important;
                padding: 12px 16px !important;
                border-radius: 15px !important;
            }

            /* Numeri di background più piccoli */
            .prize-content-section > div:nth-child(2) {
                font-size: 2.5rem !important;
                right: 15px !important;
                top: 15px !important;
            }
        }
        
        /* === CAROSELLO PREMI === */
        .prizes-carousel {
            margin: 40px auto 30px auto;
            max-width: 1200px;
            position: relative;
            overflow: hidden;
            border-radius: 25px;
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 3px solid #ffd700;
        }
        
        .carousel-title {
            text-align: center;
            color: #ffd700;
            font-size: 2.5rem;
            font-weight: 800;
            margin: 30px 0 20px 0;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .carousel-subtitle {
            text-align: center;
            color: #e2e8f0;
            font-size: 1.2rem;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .carousel-container {
            position: relative;
            width: 100%;
            height: 450px;
            overflow: hidden;
        }
        
        .carousel-track {
            display: flex;
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            height: 100%;
        }
        
        .carousel-slide {
            flex: 0 0 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 40px;
            background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(200,16,46,0.05));
        }
        
        .prize-image-carousel {
            flex: 1;
            max-width: 50%;
            text-align: center;
            padding-right: 30px;
        }
        
        .prize-image-carousel img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 2px solid #ffd700;
        }
        
        .prize-image-carousel img:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(255,215,0,0.3);
        }
        
        .prize-details-carousel {
            flex: 1;
            max-width: 50%;
            padding-left: 30px;
            color: white;
        }
        
        .prize-rank-carousel {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
        
        .prize-name-carousel {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .prize-model-carousel {
            font-size: 1.1rem;
            color: #c8102e;
            font-weight: 600;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .prize-description-carousel {
            font-size: 1rem;
            color: #a0aec0;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .prize-price-carousel {
            font-size: 2rem;
            font-weight: 900;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 10px 20px;
            display: inline-block;
            background: linear-gradient(145deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));
        }
        
        .carousel-controls {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,215,0,0.9);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            color: #002147;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .carousel-controls:hover {
            background: #ffd700;
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 8px 25px rgba(255,215,0,0.4);
        }
        
        .carousel-prev {
            left: 20px;
        }
        
        .carousel-next {
            right: 20px;
        }
        
        .carousel-indicators {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 30px 0;
            background: linear-gradient(to bottom, transparent, rgba(0,33,71,0.1));
        }
        
        .carousel-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: rgba(255,215,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #ffd700;
        }
        
        .carousel-dot.active {
            background: #ffd700;
            transform: scale(1.3);
            box-shadow: 0 0 15px rgba(255,215,0,0.6);
        }

        /* === SEZIONE ESTRAZIONE CSS === */
        
        /* Animazioni countdown */
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.3); }
            50% { box-shadow: 0 0 40px rgba(255,215,0,0.6), 0 0 60px rgba(255,215,0,0.4); }
        }
        
        /* Responsività countdown */
        @media (max-width: 768px) {
            .countdown-box {
                padding: 25px 20px !important;
                margin: 30px auto 25px auto !important;
            }
            
            .countdown-box h2 {
                font-size: 2rem !important;
                margin-bottom: 15px !important;
            }
            
            #countdown-timer, #countdown-timer-estrazione {
                gap: 15px !important;
                justify-content: center !important;
            }
            
            .time-unit {
                padding: 15px 12px !important;
                min-width: 70px !important;
            }
            
            .time-unit div:first-child {
                font-size: 2.2rem !important;
            }
            
            .estrazione-live-box {
                padding: 25px 20px !important;
            }
            
            .estrazione-live-box h2 {
                font-size: 2.2rem !important;
            }
            
            #input-numeri {
                padding: 20px 15px !important;
            }
            
            #input-numeri div:nth-child(2) {
                gap: 10px !important;
            }
            
            #input-numeri input {
                width: 60px !important;
                padding: 12px !important;
                font-size: 1.2rem !important;
            }
            
            #calcola-vincitori {
                padding: 12px 25px !important;
                font-size: 1rem !important;
            }
            
            .vincitore-card {
                flex-direction: column !important;
                text-align: center !important;
                gap: 15px !important;
            }
            
            .vincitore-card > div:first-child {
                justify-content: center !important;
            }
        }
        
        @media (max-width: 480px) {
            .countdown-box {
                padding: 20px 15px !important;
            }
            
            .countdown-box h2 {
                font-size: 1.7rem !important;
            }
            
            #countdown-timer, #countdown-timer-estrazione {
                gap: 10px !important;
                flex-wrap: wrap !important;
            }
            
            .time-unit {
                padding: 12px 10px !important;
                min-width: 60px !important;
            }
            
            .time-unit div:first-child {
                font-size: 1.8rem !important;
            }
            
            .estrazione-live-box h2 {
                font-size: 1.8rem !important;
            }
            
            #input-numeri input {
                width: 55px !important;
                padding: 10px !important;
                font-size: 1.1rem !important;
            }
            
            .vincitore-card {
                padding: 20px 15px !important;
            }
            
            .vincitore-card div:first-child div:nth-child(2) div:first-child {
                font-size: 1.2rem !important;
            }
            
            .vincitore-card div:nth-child(2) div:nth-child(2) {
                font-size: 1.5rem !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header Premium con Locandina -->
    <div class="lottery-header">
        <h1 class="lottery-title">🎄 LOTTERIA DI NATALE 2025</h1>
        <p class="lottery-subtitle">Genoa CFC - Ti Presto l'Abbonamento</p>
        
        <!-- Locandina Lotteria -->
        <div class="locandina-container">
            <img src="img/locandina-lotteria.png" alt="Locandina Lotteria Natale 2025" class="locandina-img" />
        </div>
        
        <div class="countdown-container">
            <div class="countdown-timer" id="countdownTimer">
                ⏰ Estrazione: 24 Dicembre 2025 ore 18:30
            </div>
        </div>
    </div>

    <!-- Container Principale -->
    <div class="lottery-container">
        
        <!-- Griglia Premi Elegante -->
        <div class="prizes-section" style="margin: 60px auto; max-width: 1200px; padding: 0 20px;">
            <!-- Header Section -->
            <div class="section-header" style="text-align: center; margin-bottom: 50px; position: relative;">
                <div style="display: inline-block; position: relative;">
                    <h2 style="color: #ffd700; font-size: 3rem; font-weight: 900; margin: 0; text-shadow: 3px 3px 8px rgba(0,0,0,0.8); text-transform: uppercase; letter-spacing: 3px; background: linear-gradient(45deg, #ffd700, #ffed4e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">🏆 PREMI IN PALIO</h2>
                    <div style="position: absolute; bottom: -15px; left: 50%; transform: translateX(-50%); width: 120px; height: 4px; background: linear-gradient(90deg, transparent, #ffd700, #ffed4e, #ffd700, transparent); border-radius: 2px;"></div>
                </div>
                <p style="color: #e2e8f0; font-size: 1.3rem; margin: 25px 0 0 0; font-weight: 300; opacity: 0.9;">Prodotti ufficiali Genoa CFC di <span style="color: #c8102e; font-weight: 600;">altissima qualità</span>!</p>
                <!-- Decorative elements -->
                <div style="position: absolute; top: -10px; left: 20%; width: 40px; height: 40px; background: radial-gradient(circle, rgba(255,215,0,0.3), transparent); border-radius: 50%; animation: pulse 2s infinite;"></div>
                <div style="position: absolute; bottom: 10px; right: 15%; width: 25px; height: 25px; background: radial-gradient(circle, rgba(200,16,46,0.4), transparent); border-radius: 50%; animation: pulse 3s infinite reverse;"></div>
            </div>
            
            <!-- Prizes Container -->
            <div class="prizes-container" style="display: flex; flex-direction: column; gap: 35px;">
                
                <!-- Primo Premio -->
                <div class="prize-card prize-gold" style="display: flex; background: linear-gradient(135deg, #1a1a2e 0%, #2d3748 50%, #1a202c 100%); border: 3px solid #ffd700; border-radius: 24px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; min-height: 220px;" onmouseover="this.style.transform='translateY(-8px) scale(1.02)'; this.style.boxShadow='0 35px 70px rgba(255,215,0,0.4), 0 0 40px rgba(255,215,0,0.2)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1)';">
                    <!-- Glow effect -->
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255,215,0,0.1), transparent 50%); pointer-events: none;"></div>
                    
                    <!-- Prize Rank Badge -->
                    <div style="position: absolute; top: -5px; left: -5px; z-index: 3; background: linear-gradient(135deg, #ffd700, #ffed4e); color: #1a1a2e; padding: 12px 20px; border-radius: 0 0 20px 0; font-weight: 900; font-size: 1rem; text-transform: uppercase; box-shadow: 0 8px 16px rgba(255,215,0,0.3); border: 2px solid #fff;">🥇 1° PREMIO</div>
                    
                    <!-- Image Section -->
                    <div class="prize-image-section" style="flex: 0 0 320px; position: relative; background: linear-gradient(135deg, rgba(255,215,0,0.15) 0%, rgba(200,16,46,0.08) 100%); display: flex; align-items: center; justify-content: center; padding: 25px; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, rgba(255,215,0,0.1) 0%, transparent 70%); pointer-events: none;"></div>
                        <img src="img/1premio1.png" alt="MIKELI GENOA - Giacca imbottita" style="max-width: 100%; max-height: 180px; object-fit: contain; border-radius: 15px; box-shadow: 0 15px 35px rgba(0,0,0,0.4); transition: transform 0.3s ease; position: relative; z-index: 2;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';" />
                    </div>
                    
                    <!-- Content Section -->
                    <div class="prize-content-section" style="flex: 1; padding: 35px; display: flex; flex-direction: column; justify-content: center; position: relative;">
                        <div style="position: absolute; top: 20px; right: 25px; color: rgba(255,215,0,0.3); font-size: 4rem; font-weight: 900; line-height: 1; pointer-events: none;">01</div>
                        
                        <div style="font-size: 2rem; font-weight: 800; color: #ffffff; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">MIKELI GENOA</div>
                        
                        <div style="color: #c8102e; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem; text-transform: capitalize;">Giacca imbottita da uomo - Blue dk-red blaze</div>
                        
                        <div style="color: #cbd5e0; line-height: 1.7; margin-bottom: 25px; font-size: 1.05rem; font-weight: 400;">Giacca imbottita da uomo blu scuro con logo della squadra. <span style="color: #ffd700; font-weight: 600;">Perfetta per le giornate più fredde allo stadio!</span></div>
                        
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #ffd700; border: 3px solid #ffd700; border-radius: 18px; padding: 18px 30px; background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,215,0,0.05)); text-shadow: 2px 2px 6px rgba(0,0,0,0.8); box-shadow: 0 8px 20px rgba(255,215,0,0.2); position: relative; overflow: hidden;">€149,00
                                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent); transform: rotate(45deg); animation: shimmer 3s infinite;"></div>
                            </div>
                            <div style="color: #68d391; font-size: 0.9rem; font-weight: 600; opacity: 0.8;">💎 Premio Premium</div>
                        </div>
                    </div>
                </div>
                
                <!-- Secondo Premio -->
                <div class="prize-card prize-silver" style="display: flex; background: linear-gradient(135deg, #1a1a2e 0%, #2d3748 50%, #1a202c 100%); border: 3px solid #c0c0c0; border-radius: 24px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; min-height: 220px;" onmouseover="this.style.transform='translateY(-8px) scale(1.02)'; this.style.boxShadow='0 35px 70px rgba(192,192,192,0.4), 0 0 40px rgba(192,192,192,0.2)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1)';">
                    <!-- Glow effect -->
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(192,192,192,0.1), transparent 50%); pointer-events: none;"></div>
                    
                    <!-- Prize Rank Badge -->
                    <div style="position: absolute; top: -5px; left: -5px; z-index: 3; background: linear-gradient(135deg, #c0c0c0, #e5e5e5); color: #1a1a2e; padding: 12px 20px; border-radius: 0 0 20px 0; font-weight: 900; font-size: 1rem; text-transform: uppercase; box-shadow: 0 8px 16px rgba(192,192,192,0.3); border: 2px solid #fff;">🥈 2° PREMIO</div>
                    
                    <!-- Image Section -->
                    <div class="prize-image-section" style="flex: 0 0 320px; position: relative; background: linear-gradient(135deg, rgba(192,192,192,0.15) 0%, rgba(200,16,46,0.08) 100%); display: flex; align-items: center; justify-content: center; padding: 25px; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, rgba(192,192,192,0.1) 0%, transparent 70%); pointer-events: none;"></div>
                        <img src="img/2premio1.png" alt="MEQUO GENOA - Giacca in pile" style="max-width: 100%; max-height: 180px; object-fit: contain; border-radius: 15px; box-shadow: 0 15px 35px rgba(0,0,0,0.4); transition: transform 0.3s ease; position: relative; z-index: 2;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';" />
                    </div>
                    
                    <!-- Content Section -->
                    <div class="prize-content-section" style="flex: 1; padding: 35px; display: flex; flex-direction: column; justify-content: center; position: relative;">
                        <div style="position: absolute; top: 20px; right: 25px; color: rgba(192,192,192,0.3); font-size: 4rem; font-weight: 900; line-height: 1; pointer-events: none;">02</div>
                        
                        <div style="font-size: 2rem; font-weight: 800; color: #ffffff; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">MEQUO GENOA</div>
                        
                        <div style="color: #c8102e; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem; text-transform: capitalize;">Giacca in pile da uomo - Blue dk-red blaze</div>
                        
                        <div style="color: #cbd5e0; line-height: 1.7; margin-bottom: 25px; font-size: 1.05rem; font-weight: 400;">Giacca in pile blu da uomo con cappuccio e vestibilità slim. <span style="color: #c0c0c0; font-weight: 600;">Comfort e stile per i veri tifosi!</span></div>
                        
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #c0c0c0; border: 3px solid #c0c0c0; border-radius: 18px; padding: 18px 30px; background: linear-gradient(135deg, rgba(192,192,192,0.15), rgba(192,192,192,0.05)); text-shadow: 2px 2px 6px rgba(0,0,0,0.8); box-shadow: 0 8px 20px rgba(192,192,192,0.2); position: relative; overflow: hidden;">€79,00
                                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent); transform: rotate(45deg); animation: shimmer 3s infinite;"></div>
                            </div>
                            <div style="color: #68d391; font-size: 0.9rem; font-weight: 600; opacity: 0.8;">⭐ Qualità Top</div>
                        </div>
                    </div>
                </div>
                
                <!-- Terzo Premio -->
                <div class="prize-card prize-bronze" style="display: flex; background: linear-gradient(135deg, #1a1a2e 0%, #2d3748 50%, #1a202c 100%); border: 3px solid #cd7f32; border-radius: 24px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; min-height: 220px;" onmouseover="this.style.transform='translateY(-8px) scale(1.02)'; this.style.boxShadow='0 35px 70px rgba(205,127,50,0.4), 0 0 40px rgba(205,127,50,0.2)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 20px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1)';">
                    <!-- Glow effect -->
                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(205,127,50,0.1), transparent 50%); pointer-events: none;"></div>
                    
                    <!-- Prize Rank Badge -->
                    <div style="position: absolute; top: -5px; left: -5px; z-index: 3; background: linear-gradient(135deg, #cd7f32, #daa520); color: #ffffff; padding: 12px 20px; border-radius: 0 0 20px 0; font-weight: 900; font-size: 1rem; text-transform: uppercase; box-shadow: 0 8px 16px rgba(205,127,50,0.3); border: 2px solid #fff;">🥉 3° PREMIO</div>
                    
                    <!-- Image Section -->
                    <div class="prize-image-section" style="flex: 0 0 320px; position: relative; background: linear-gradient(135deg, rgba(205,127,50,0.15) 0%, rgba(200,16,46,0.08) 100%); display: flex; align-items: center; justify-content: center; padding: 25px; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, rgba(205,127,50,0.1) 0%, transparent 70%); pointer-events: none;"></div>
                        <img src="img/3premio1.png" alt="20.3H GENOA - Pallone da calcio" style="max-width: 100%; max-height: 180px; object-fit: contain; border-radius: 15px; box-shadow: 0 15px 35px rgba(0,0,0,0.4); transition: transform 0.3s ease; position: relative; z-index: 2;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';" />
                    </div>
                    
                    <!-- Content Section -->
                    <div class="prize-content-section" style="flex: 1; padding: 35px; display: flex; flex-direction: column; justify-content: center; position: relative;">
                        <div style="position: absolute; top: 20px; right: 25px; color: rgba(205,127,50,0.3); font-size: 4rem; font-weight: 900; line-height: 1; pointer-events: none;">03</div>
                        
                        <div style="font-size: 2rem; font-weight: 800; color: #ffffff; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">20.3H GENOA</div>
                        
                        <div style="color: #c8102e; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem; text-transform: capitalize;">Pallone da calcio - White-red-blue dk-yellow</div>
                        
                        <div style="color: #cbd5e0; line-height: 1.7; margin-bottom: 25px; font-size: 1.05rem; font-weight: 400;">Pallone da calcio da allenamento unisex grigio a 14 pannelli. <span style="color: #cd7f32; font-weight: 600;">Per allenarsi con lo spirito rossoblù!</span></div>
                        
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #cd7f32; border: 3px solid #cd7f32; border-radius: 18px; padding: 18px 30px; background: linear-gradient(135deg, rgba(205,127,50,0.15), rgba(205,127,50,0.05)); text-shadow: 2px 2px 6px rgba(0,0,0,0.8); box-shadow: 0 8px 20px rgba(205,127,50,0.2); position: relative; overflow: hidden;">€30,00
                                <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent); transform: rotate(45deg); animation: shimmer 3s infinite;"></div>
                            </div>
                            <div style="color: #68d391; font-size: 0.9rem; font-weight: 600; opacity: 0.8;">⚽ Ufficiale</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Regolamento -->
            <div style="text-align: center; margin-top: 45px; padding: 30px 25px; background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(200,16,46,0.1)); border-radius: 20px; border: 2px solid rgba(255,215,0,0.3); box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
                <p style="color: #ffd700; font-size: 1.3rem; font-weight: 700; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">📋 REGOLAMENTO LOTTERIA</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; color: #e2e8f0;">
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="font-size: 1.5rem; margin-bottom: 5px;">💰</div>
                        <strong>Prezzo numero:</strong><br>€5,00
                    </div>
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🎯</div>
                        <strong>Max per persona:</strong><br>10 numeri
                    </div>
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🎄</div>
                        <strong>Estrazione:</strong><br>24 Dicembre 2025
                    </div>
                    <div style="padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="font-size: 1.5rem; margin-bottom: 5px;">🏆</div>
                        <strong>Totale premi:</strong><br>€258,00
                    </div>
                </div>
            </div>
        </div>

        <!-- === SEZIONE ESTRAZIONE LIVE === -->
        <div id="estrazione-section" class="estrazione-container" style="margin: 60px auto; max-width: 1200px; padding: 0 20px;">
            
            <!-- Countdown Vendite (fino alle 18:00 del 24/12) -->
            <div id="countdown-vendite" class="countdown-box" style="text-align: center; margin-bottom: 40px; padding: 40px 30px; background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(200,16,46,0.15)); border: 3px solid rgba(255,215,0,0.4); border-radius: 25px; box-shadow: 0 15px 40px rgba(255,215,0,0.3);">
                <h2 style="color: #ffd700; font-size: 2.5rem; font-weight: 900; margin-bottom: 20px; text-shadow: 3px 3px 8px rgba(0,0,0,0.8);">⏰ VENDITE APERTE</h2>
                <p id="vendite-status" style="color: #e2e8f0; font-size: 1.2rem; margin-bottom: 30px;">Puoi acquistare numeri fino a <strong style="color: #ffd700;">DOMANI ore 18:00</strong></p>
                
                <div id="countdown-timer" style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
                    <div class="time-unit" style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; min-width: 80px;">
                        <div id="hours" style="font-size: 3rem; font-weight: 900; color: #ffd700;">00</div>
                        <div style="font-size: 1rem; color: #cbd5e0; text-transform: uppercase;">Ore</div>
                    </div>
                    <div class="time-unit" style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; min-width: 80px;">
                        <div id="minutes" style="font-size: 3rem; font-weight: 900; color: #ffd700;">00</div>
                        <div style="font-size: 1rem; color: #cbd5e0; text-transform: uppercase;">Min</div>
                    </div>
                    <div class="time-unit" style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; min-width: 80px;">
                        <div id="seconds" style="font-size: 3rem; font-weight: 900; color: #ffd700;">00</div>
                        <div style="font-size: 1rem; color: #cbd5e0; text-transform: uppercase;">Sec</div>
                    </div>
                </div>
                
                <div id="vendite-alert" style="padding: 15px; background: rgba(255,215,0,0.15); border-radius: 12px; border: 2px solid rgba(255,215,0,0.3);">
                    <span style="color: #ffd700; font-size: 1.1rem; font-weight: 600;">🔥 Affrettati! Solo poche ore rimaste per partecipare!</span>
                </div>
            </div>

            <!-- Countdown Estrazione (dalle 18:00 alle 18:30 del 24/12) -->
            <div id="countdown-estrazione" class="countdown-box" style="display: none; text-align: center; margin-bottom: 40px; padding: 40px 30px; background: linear-gradient(135deg, rgba(200,16,46,0.2), rgba(255,215,0,0.15)); border: 3px solid rgba(200,16,46,0.4); border-radius: 25px; box-shadow: 0 15px 40px rgba(200,16,46,0.3);">
                <h2 style="color: #c8102e; font-size: 2.5rem; font-weight: 900; margin-bottom: 20px; text-shadow: 3px 3px 8px rgba(0,0,0,0.8);">🔒 VENDITE CHIUSE</h2>
                <p style="color: #e2e8f0; font-size: 1.2rem; margin-bottom: 30px;">Estrazione tra poco alle <strong style="color: #c8102e;">ore 18:30</strong></p>
                
                <div id="countdown-timer-estrazione" style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
                    <div class="time-unit" style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; min-width: 80px;">
                        <div id="minutes-est" style="font-size: 3rem; font-weight: 900; color: #c8102e;">00</div>
                        <div style="font-size: 1rem; color: #cbd5e0; text-transform: uppercase;">Min</div>
                    </div>
                    <div class="time-unit" style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; min-width: 80px;">
                        <div id="seconds-est" style="font-size: 3rem; font-weight: 900; color: #c8102e;">00</div>
                        <div style="font-size: 1rem; color: #cbd5e0; text-transform: uppercase;">Sec</div>
                    </div>
                </div>
                
                <div style="padding: 15px; background: rgba(200,16,46,0.15); border-radius: 12px; border: 2px solid rgba(200,16,46,0.3);">
                    <span style="color: #c8102e; font-size: 1.1rem; font-weight: 600;">⏳ Preparazione estrazione in corso...</span>
                </div>
            </div>

            <!-- Estrazione Live (dalle 18:30 in poi) -->
            <div id="estrazione-live" class="estrazione-live-box" style="display: block; text-align: center; margin-bottom: 40px; padding: 40px 30px; background: linear-gradient(135deg, #1a1a2e, #2d3748, #1a202c); border: 3px solid #ffd700; border-radius: 25px; box-shadow: 0 20px 50px rgba(255,215,0,0.4), 0 0 40px rgba(255,215,0,0.2);">
                <h2 style="color: #ffd700; font-size: 2.8rem; font-weight: 900; margin-bottom: 20px; text-shadow: 3px 3px 8px rgba(0,0,0,0.8);">� RISULTATI UFFICIALI</h2>
                <p style="color: #e2e8f0; font-size: 1.3rem; margin-bottom: 30px;">Ruota di <strong style="color: #c8102e;">GENOVA</strong> - Mercoledì 24 Dicembre 2025</p>
                
                <!-- Numeri Estratti Ufficiali -->
                <div id="numeri-estratti-finali" style="margin-bottom: 40px; padding: 30px; background: rgba(0,0,0,0.4); border-radius: 15px; border: 3px solid rgba(255,215,0,0.6); box-shadow: 0 15px 40px rgba(255,215,0,0.3);">
                    <h3 style="color: #ffd700; margin-bottom: 25px; font-size: 1.8rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">🎯 NUMERI ESTRATTI RUOTA DI GENOVA</h3>
                    <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 25px; flex-wrap: wrap;">
                        <div style="background: linear-gradient(135deg, #ffd700, #ffed4e); color: #1a1a2e; width: 90px; height: 90px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; font-weight: 900; box-shadow: 0 10px 25px rgba(255,215,0,0.4); border: 4px solid #ffd700;">20</div>
                        <div style="background: linear-gradient(135deg, #c0c0c0, #e0e0e0); color: #1a1a2e; width: 90px; height: 90px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; font-weight: 900; box-shadow: 0 10px 25px rgba(192,192,192,0.4); border: 4px solid #c0c0c0;">44</div>
                        <div style="background: linear-gradient(135deg, #cd7f32, #daa555); color: #1a1a2e; width: 90px; height: 90px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; font-weight: 900; box-shadow: 0 10px 25px rgba(205,127,50,0.4); border: 4px solid #cd7f32;">89</div>
                    </div>
                    <p style="color: #68d391; font-size: 1.1rem; font-weight: 600; margin-bottom: 10px;">✅ ESTRAZIONE UFFICIALE CONCLUSA</p>
                    <p style="color: #e2e8f0; font-size: 1rem;">24 Dicembre 2025 alle ore 18:30</p>
                </div>

                <!-- Risultati Estrazione -->
                <div id="risultati-estrazione" style="display: block;">
                    <h3 style="color: #ffd700; font-size: 2rem; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">🏆 VINCITORI UFFICIALI</h3>
                    
                    <!-- Vincitori -->
                    <div style="display: flex; flex-direction: column; gap: 25px; margin-bottom: 40px;">
                        <!-- 1° Premio -->
                        <div id="vincitore-1" class="vincitore-card" style="padding: 25px; background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,215,0,0.1)); border: 3px solid #ffd700; border-radius: 20px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px; animation: pulse 2s infinite;">
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <div style="font-size: 3rem;">🥇</div>
                                <div>
                                    <div style="color: #ffd700; font-size: 1.5rem; font-weight: 900;">1° PREMIO - NUMERO <span id="numero-vincente-1">20</span></div>
                                    <div style="color: #e2e8f0; font-size: 1.1rem;">Vincitore: <span id="nome-vincitore-1">🎉 ALYSEA</span></div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #ffd700; font-size: 1.3rem; font-weight: 700;">MIKELI GENOA</div>
                                <div style="color: #e2e8f0; font-size: 1.8rem; font-weight: 900;">€149,00</div>
                            </div>
                        </div>

                        <!-- 2° Premio -->
                        <div id="vincitore-2" class="vincitore-card" style="padding: 25px; background: linear-gradient(135deg, rgba(192,192,192,0.2), rgba(192,192,192,0.1)); border: 3px solid #c0c0c0; border-radius: 20px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px;">
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <div style="font-size: 3rem;">🥈</div>
                                <div>
                                    <div style="color: #c0c0c0; font-size: 1.5rem; font-weight: 900;">2° PREMIO - NUMERO <span id="numero-vincente-2">44</span></div>
                                    <div style="color: #e2e8f0; font-size: 1.1rem;">Vincitore: <span id="nome-vincitore-2">⭐ Numero non venduto</span></div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #c0c0c0; font-size: 1.3rem; font-weight: 700;">MEQUO GENOA</div>
                                <div style="color: #e2e8f0; font-size: 1.8rem; font-weight: 900;">€79,00</div>
                            </div>
                        </div>

                        <!-- 3° Premio -->
                        <div id="vincitore-3" class="vincitore-card" style="padding: 25px; background: linear-gradient(135deg, rgba(205,127,50,0.2), rgba(205,127,50,0.1)); border: 3px solid #cd7f32; border-radius: 20px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px; animation: pulse 2s infinite;">
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <div style="font-size: 3rem;">🥉</div>
                                <div>
                                    <div style="color: #cd7f32; font-size: 1.5rem; font-weight: 900;">3° PREMIO - NUMERO <span id="numero-vincente-3">89</span></div>
                                    <div style="color: #e2e8f0; font-size: 1.1rem;">Vincitore: <span id="nome-vincitore-3">🎉 LAURA BRUNO</span></div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #cd7f32; font-size: 1.3rem; font-weight: 700;">20.3H GENOA</div>
                                <div style="color: #e2e8f0; font-size: 1.8rem; font-weight: 900;">€30,00</div>
                            </div>
                        </div>
                    </div>

                    <!-- Certificazione -->
                    <div style="padding: 20px; background: rgba(0,0,0,0.3); border-radius: 15px; border: 2px solid rgba(255,215,0,0.3);">
                        <p style="color: #68d391; font-size: 1.1rem; font-weight: 600; margin-bottom: 10px;">✅ Estrazione Certificata</p>
                        <p style="color: #cbd5e0; font-size: 0.9rem;">Risultati basati sull'estrazione ufficiale del Lotto - Ruota di Genova<br>
                        Data: <span id="data-estrazione">24 Dicembre 2025 ore 18:30</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Griglia Numeri -->
        <div class="info-panel">
            <h2 style="text-align: center; margin-bottom: 20px;">� LOTTERIA CONCLUSA - NUMERI VENDUTI</h2>
            <div id="numbersStats" style="text-align: center; margin-bottom: 20px;"></div>
            <div class="numbers-grid" id="numbersGrid">
                <!-- Numeri generati dinamicamente -->
            </div>
        </div>

        <!-- Pannello Lotteria Conclusa -->
        <div class="selection-panel" id="selectionPanel" style="background: linear-gradient(135deg, rgba(100,100,100,0.3), rgba(50,50,50,0.2)); border: 2px solid #666;">
            <div style="text-align: center; padding: 20px;">
                <h3 style="color: #c8102e; margin-bottom: 15px; font-size: 1.8rem;">🚫 LOTTERIA CONCLUSA</h3>
                <p style="color: #e2e8f0; font-size: 1.1rem; margin-bottom: 15px;">L'estrazione si è tenuta il <strong>24 Dicembre 2025 alle 18:30</strong></p>
                <p style="color: #ffd700; font-size: 1rem;">✅ Visualizza i risultati nella sezione <strong>"RISULTATI UFFICIALI"</strong> qui sopra</p>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(200,16,46,0.2); border-radius: 10px; border: 1px solid rgba(200,16,46,0.4);">
                    <p style="color: #ff6b6b; font-size: 0.9rem; margin: 0;">🔒 Gli acquisti sono definitivamente chiusi</p>
                </div>
            </div>
        </div>

        <!-- Lista Acquisti -->
        <div class="purchases-section" id="purchasesSection">
            <h2>📊 NUMERI GIÀ VENDUTI</h2>
            <div id="purchasesList">
                <!-- Lista popolata dinamicamente -->
            </div>
        </div>

    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Include Lottery Script (opzionale) -->
    <script src="lottery.js" onerror="console.log('⚠️ lottery.js non trovato, uso modalità standalone')"></script>
    
    <script>
        // === CONFIGURAZIONE FIREBASE ===
        const firebaseConfig = {
            apiKey: "AIzaSyCkfRCcKPXLG4i2Iu6DVZQj5Gz_XciSpiY",
            authDomain: "abbonamentigenoa.firebaseapp.com",
            projectId: "abbonamentigenoa",
            storageBucket: "abbonamentigenoa.firebasestorage.app",
            messagingSenderId: "62498001959",
            appId: "1:62498001959:web:ae674e418db3190dac2a02",
            measurementId: "G-E6S3XV4K3D"
        };

        // Inizializza Firebase una sola volta
        if (!firebase.apps || firebase.apps.length === 0) {
            firebase.initializeApp(firebaseConfig);
        }
        
        // Firebase refs (globali)
        let firebaseDB = null;
        let lotteryFirebaseRef = null;

        // === STORAGE SICURO MIGLIORATO ===
        const safeLocalStorage = {
            isAvailable: false,
            fallbackData: {},
            
            init() {
                try {
                    localStorage.setItem('__test__', 'test');
                    localStorage.removeItem('__test__');
                    this.isAvailable = true;
                    console.log('💾 localStorage disponibile');
                } catch (e) {
                    this.isAvailable = false;
                    console.log('⚠️ localStorage bloccato - uso memoria temporanea');
                }
            },
            
            get: function(key) {
                if (safeLocalStorage.isAvailable) {
                    try {
                        const value = localStorage.getItem(key);
                        if (value !== null) return value;
                    } catch (e) {
                        safeLocalStorage.isAvailable = false;
                    }
                }
                return safeLocalStorage.fallbackData[key] || null;
            },
            
            set: function(key, value) {
                if (safeLocalStorage.isAvailable) {
                    try {
                        localStorage.setItem(key, value);
                        return true;
                    } catch (e) {
                        safeLocalStorage.isAvailable = false;
                    }
                }
                safeLocalStorage.fallbackData[key] = value;
                return true;
            },
            
            remove: function(key) {
                if (safeLocalStorage.isAvailable) {
                    try {
                        localStorage.removeItem(key);
                    } catch (e) {
                        safeLocalStorage.isAvailable = false;
                    }
                }
                delete safeLocalStorage.fallbackData[key];
                return true;
            }
        };
        
        // Inizializza il sistema storage
        safeLocalStorage.init();
        
        // Nascondi warning localStorage non critici (versione migliorata)
        const originalWarn = console.warn;
        const originalError = console.error;
        
        console.warn = function(...args) {
            const message = args.join(' ');
            if (message.includes('Tracking Prevention blocked access to storage') ||
                message.includes('localStorage non disponibile')) {
                // Ignora silenziosamente - già gestito
                return;
            }
            originalWarn.apply(console, args);
        };
        
        console.error = function(...args) {
            const message = args.join(' ');
            if (message.includes('Tracking Prevention blocked access to storage')) {
                // Converti in warning discreto
                console.info('🔒 Modalità privacy attiva');
                return;
            }
            originalError.apply(console, args);
        };

        // === GESTIONE UI ===
        
        // Stato globale lotteria
        let selectedNumbers = [];
        const maxNumbers = 10;
        const pricePerNumber = 5;
        
        // Inizializza al caricamento pagina
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎄 Inizializzazione lotteria...');
            
            // Prima inizializza Firebase (se disponibile) in modalità silenziosa
            if (window.initializeFirebaseLottery && typeof window.initializeFirebaseLottery === 'function') {
                window.initializeFirebaseLottery().then(firebaseReady => {
                    if (firebaseReady) {
                        console.log('🔥 Firebase sync attivo');
                        firebaseDB = firebase.firestore();
                        lotteryFirebaseRef = firebaseDB.collection('lottery').doc('christmas2025');
                    } else {
                        console.log('💾 Modalità offline attiva');
                        if (window.showToast) {
                            setTimeout(() => {
                                showToast('📱 Modalità offline - i tuoi acquisti saranno salvati!', 'info', 3000);
                            }, 1000);
                        }
                    }
                    
                    // Poi inizializza UI
                    initializeLottery();
                    setupEventListeners();
                    startCountdown();
                    handlePayPalReturn();
                }).catch(error => {
                    console.error('❌ Errore Firebase, uso localStorage:', error);
                    initializeLottery();
                    setupEventListeners();
                    startCountdown();
                    handlePayPalReturn();
                });
            } else {
                // Fallback diretto
                console.log('💾 Solo localStorage disponibile');
                initializeLottery();
                setupEventListeners();
                startCountdown();
                handlePayPalReturn();
            }
        });
        
        function initializeLottery() {
            console.log('🎲 Generazione griglia numeri...');
            generateNumbersGrid();
            console.log('🔄 Aggiornamento UI...');
            updateUI();
            console.log('📋 Caricamento lista acquisti...');
            updatePurchasesList(); // Carica la lista acquisti
            console.log('🎄 Lotteria di Natale inizializzata!');
        }
        
        function generateNumbersGrid() {
            const grid = document.getElementById('numbersGrid');
            if (!grid) {
                console.error('❌ Container numbersGrid non trovato!');
                return;
            }
            
            console.log('🏆 Generazione griglia numeri - LOTTERIA CONCLUSA');
            grid.innerHTML = '';
            
            // Ottieni numeri venduti
            const soldNumbers = getSoldNumbers();
            
            for (let i = 1; i <= 90; i++) {
                const numberBox = document.createElement('div');
                
                // Tutti i numeri sono ora disabilitati
                if (soldNumbers.includes(i)) {
                    numberBox.className = 'number-box sold disabled';
                    numberBox.style.background = '#666';
                    numberBox.style.color = '#999';
                    numberBox.style.cursor = 'not-allowed';
                } else {
                    numberBox.className = 'number-box disabled';
                    numberBox.style.background = '#444';
                    numberBox.style.color = '#777';
                    numberBox.style.cursor = 'not-allowed';
                }
                
                numberBox.textContent = i;
                numberBox.dataset.number = i;
                numberBox.title = 'Lotteria conclusa - Acquisti non più disponibili';
                
                // Nessun event listener - completamente disabilitato
                grid.appendChild(numberBox);
            }
            
            console.log('✅ Griglia bloccata - 90 numeri non più acquistabili!');
        }
        
        function selectNumber(number) {
            // LOTTERIA CONCLUSA - Nessuna selezione possibile
            showToast('🚫 Lotteria conclusa! L\'estrazione si è tenuta il 24/12/2025 alle 18:30', 'error', 5000);
            console.log('❌ Tentativo di selezione bloccato - Lotteria conclusa');
            return;
        }
                    return;
                }
                
                selectedNumbers.push(number);
                showToast(`✨ Numero ${number} aggiunto! (${selectedNumbers.length}/${maxNumbers})`, 'success', 2000);
                
                // Effetto visivo seleziona
                if (numberBox) {
                    numberBox.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        numberBox.style.transform = 'scale(1.05)';
                    }, 200);
                }
            }
            
            updateUI();
            
            // Suono di click (se disponibile)
            playClickSound();
        }
        
        function playClickSound() {
            // Crea un suono di click semplice usando Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                // Audio non supportato, ignora
            }
        }
        
        // Calcola i numeri già venduti dalle prevendite
        function getSoldNumbers() {
            const prevendite = [
                { numbers: [6,10,16] },
                { numbers: [4] },
                { numbers: [28,66] },
                { numbers: [9,57] },
                { numbers: [8] },
                { numbers: [89,29] },
                { numbers: [22] },
                { numbers: [69] },
                { numbers: [13] },
                { numbers: [35] },
                { numbers: [59] },
                { numbers: [90] },
                { numbers: [11,21,73] },
                { numbers: [7] },
                { numbers: [14] },
                { numbers: [20] },
                { numbers: [32] },
                { numbers: [84] },
                { numbers: [46] },
                { numbers: [5,25,36] },
                { numbers: [24,43,50] },
                { numbers: [15,77] },
                { numbers: [17,19] },
                { numbers: [23] },
                { numbers: [42,61] }
            ];
            
            let soldNumbers = [];
            prevendite.forEach(purchase => {
                soldNumbers = [...soldNumbers, ...purchase.numbers];
            });
            
            // ⚠️ DISABILITATO per evitare duplicazioni - Firebase sync non necessario per prevendite hardcoded
            // if (window.lotteryState && window.lotteryState.purchasedNumbers) {
            //     window.lotteryState.purchasedNumbers.forEach(purchase => {
            //         soldNumbers = [...soldNumbers, ...purchase.numbers];
            //     });
            // }
            
            return soldNumbers;
        }
        
        function updateUI() {
            const soldNumbers = getSoldNumbers();
            
            // Aggiorna griglia
            document.querySelectorAll('.number-box').forEach(box => {
                const number = parseInt(box.dataset.number);
                box.className = 'number-box';
                
                if (selectedNumbers.includes(number)) {
                    box.classList.add('selected');
                } else if (soldNumbers.includes(number)) {
                    box.classList.add('sold');
                    box.style.pointerEvents = 'none'; // Disabilita click
                } else {
                    box.classList.add('available');
                    box.style.pointerEvents = 'auto'; // Abilita click
                }
            });
            
            // Aggiorna pannello selezione
            const selectedEl = document.getElementById('selectedNumbers');
            const priceEl = document.getElementById('totalPrice');
            const buyBtn = document.getElementById('buyButton');
            
            if (selectedNumbers.length > 0) {
                selectedEl.innerHTML = `
                    <strong>🎯 Numeri selezionati:</strong><br>
                    <span style="font-size: 1.5rem; color: #ffd700;">${selectedNumbers.sort((a,b) => a-b).join(', ')}</span>
                `;
                const totalPrice = selectedNumbers.length * pricePerNumber;
                priceEl.innerHTML = `
                    <span style="color: #4ade80;">${selectedNumbers.length} × €5 = </span>
                    <strong>€${totalPrice.toFixed(2)}</strong>
                `;
                buyBtn.disabled = false;
                buyBtn.style.opacity = '1';
            } else {
                selectedEl.innerHTML = '🎯 Clicca sui numeri per selezionarli<br><small>(massimo 10 numeri)</small>';
                priceEl.innerHTML = '€0,00';
                buyBtn.disabled = true;
                buyBtn.style.opacity = '0.5';
            }
            
            // Aggiorna contatori
            updateCounters();
        }
        
        function updateCounters() {
            const soldNumbers = getSoldNumbers();
            const soldCount = soldNumbers.length;
            const availableCount = 90 - soldCount;
            const selectedCount = selectedNumbers.length;
            
            // Mostra statistiche
            const statsHtml = `
                <div style="display: flex; justify-content: space-around; margin-top: 15px; font-size: 0.9rem;">
                    <span>🔴 Venduti: <strong>${soldCount}</strong></span>
                    <span>🟢 Disponibili: <strong>${availableCount}</strong></span>
                    <span>⭐ Selezionati: <strong>${selectedCount}/10</strong></span>
                </div>
            `;
            
            const statsContainer = document.getElementById('numbersStats');
            if (statsContainer) {
                statsContainer.innerHTML = statsHtml;
            }
        }
        
        function setupEventListeners() {
            // Pulsante acquisto
            document.getElementById('buyButton').addEventListener('click', processPayment);
            
            // Pulsante cancella
            document.getElementById('clearButton').addEventListener('click', () => {
                selectedNumbers = [];
                updateUI();
            });
        }
        
        function processPayment() {
            if (selectedNumbers.length === 0) {
                showToast('Seleziona almeno un numero!', 'error');
                return;
            }
            
            // Verifica che i numeri non siano già venduti
            const soldNumbers = getSoldNumbers();
            const conflicts = selectedNumbers.filter(num => soldNumbers.includes(num));
            
            if (conflicts.length > 0) {
                showToast(`Numeri ${conflicts.join(', ')} già venduti da altri utenti!`, 'error');
                return;
            }
            
            // Calcola totale
            const total = selectedNumbers.length * pricePerNumber;
            
            // Salva dati per PayPal return
            const paymentData = {
                numbers: [...selectedNumbers],
                total: total,
                timestamp: Date.now(),
                buyer: {
                    name: prompt('Inserisci il tuo nome per la registrazione:') || 'Anonimo'
                }
            };
            
            if (safeLocalStorage.set('lotteryPaymentData', JSON.stringify(paymentData))) {
                console.log('✅ Dati pagamento salvati');
            } else {
                console.warn('⚠️ Impossibile salvare dati pagamento');
            }
            
            // Crea form PayPal
            createPayPalForm(paymentData);
        }
        
        function createPayPalForm(data) {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = 'https://www.paypal.com/cgi-bin/webscr';
            form.style.display = 'none';
            
            const fields = {
                'cmd': '_xclick',
                'business': 'dnagenoa@outlook.it',
                'item_name': `Lotteria Natale 2025 - Numeri: ${data.numbers.join(', ')}`,
                'amount': data.total.toFixed(2),
                'currency_code': 'EUR',
                'return': window.location.href + '?lottery=success',
                'cancel_return': window.location.href + '?lottery=cancelled'
            };
            
            Object.keys(fields).forEach(key => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = fields[key];
                form.appendChild(input);
            });
            
            document.body.appendChild(form);
            form.submit();
        }
        
        function loadLotteryData() {
            // Carica dati da Firebase o localStorage
            if (typeof loadLotteryFromLocalStorage === 'function') {
                loadLotteryFromLocalStorage();
            }
            updatePurchasesList();
        }
        
        function updatePurchasesList() {
            console.log('🔄 Aggiornamento lista acquisti...');
            const container = document.getElementById('purchasesList');
            
            if (!container) {
                console.error('❌ Container purchasesList non trovato!');
                return;
            }
            
            console.log('✅ Container trovato, carico prevendite...');
            
            // Dati pre-vendite (26 numeri già venduti - conteggio corretto)
            const prevendite = [
                { numbers: [6,10,16], buyerName: "Antonella Bruno", method: "Contanti", total: 15, timestamp: Date.now() - 86400000 },
                { numbers: [4], buyerName: "Lina Galuppo", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [28,66], buyerName: "Francesco Sidero", method: "Contanti", total: 10, timestamp: Date.now() - 86400000 },
                { numbers: [9,57], buyerName: "Rocco Palmisano", method: "Contanti", total: 10, timestamp: Date.now() - 86400000 },
                { numbers: [8], buyerName: "Francesca Dylan", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [89,29], buyerName: "Laura Bruno", method: "Contanti", total: 10, timestamp: Date.now() - 86400000 },
                { numbers: [22], buyerName: "Carla (Mamma Federico)", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [69], buyerName: "Manuela Giordano", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [13], buyerName: "Francesco Petronelli", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [35], buyerName: "Ylenia Tarantino", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [59], buyerName: "Giada Sidero", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [90], buyerName: "Sidero Alessandro", method: "Contanti", total: 5, timestamp: Date.now() - 86400000 },
                { numbers: [11,21,73], buyerName: "Ilaria Sarah Biancalana", method: "PayPal", total: 15, timestamp: Date.now() - 3600000 },
                { numbers: [7], buyerName: "Mauro Pastorino", method: "PayPal", total: 5, timestamp: Date.now() - 1800000 },
                { numbers: [14], buyerName: "Claudio Satta", method: "PayPal", total: 5, timestamp: Date.now() - 1200000 },
                { numbers: [20], buyerName: "Alysea", method: "Contanti", total: 5, timestamp: Date.now() - 600000 },
                { numbers: [32], buyerName: "Simone Stadio cappellino", method: "Contanti", total: 5, timestamp: Date.now() - 300000 },
                { numbers: [84], buyerName: "Carlo Stadio Amico simone", method: "Contanti", total: 5, timestamp: Date.now() - 180000 },
                { numbers: [46], buyerName: "Alby Katia", method: "Contanti", total: 5, timestamp: Date.now() - 60000 },
                { numbers: [5,25,36], buyerName: "Carlo Carletti", method: "PayPal", total: 15, timestamp: Date.now() - 30000 },
                { numbers: [24,43,50], buyerName: "Ilaria Biancalana", method: "PayPal", total: 15, timestamp: Date.now() - 15000 },
                { numbers: [15,77], buyerName: "Daniela Carla Mattia", method: "PayPal", total: 10, timestamp: Date.now() - 5000 },
                { numbers: [17,19], buyerName: "Eliana Pesce", method: "PayPal", total: 10, timestamp: Date.now() - 2000 },
                { numbers: [23], buyerName: "Sidero Alessandro", method: "PayPal", total: 5, timestamp: Date.now() - 1500 },
                { numbers: [42,61], buyerName: "Emilia Opisso", method: "PayPal", total: 10, timestamp: Date.now() - 1000 }
            ];
            
            // Combina prevendite con acquisti online (se esistenti)
            let allPurchases = [...prevendite];
            
            // ⚠️ DISABILITATO - Utilizziamo solo la lista hardcoded per evitare duplicati
            // if (window.lotteryState && window.lotteryState.purchasedNumbers) {
            //     // Aggiungi nuovi acquisti online
            //     const onlinePurchases = window.lotteryState.purchasedNumbers.filter(purchase => 
            //         purchase.method === 'PayPal'
            //     );
            //     allPurchases = [...allPurchases, ...onlinePurchases];
            // }
            
            // Ordina per timestamp (più recenti prima)
            allPurchases.sort((a, b) => b.timestamp - a.timestamp);
            
            if (allPurchases.length === 0) {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">Nessun acquisto registrato</p>';
                return;
            }
            
            container.innerHTML = '';
            
            allPurchases.forEach((purchase, index) => {
                const item = document.createElement('div');
                item.className = 'purchase-item';
                
                // Determina se è nuovo (meno di 30 secondi fa)
                const isNew = purchase.method === 'PayPal' && (Date.now() - purchase.timestamp) < 30000;
                
                item.innerHTML = `
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                            <strong style="color: #ffd700;">${purchase.buyerName}</strong>
                            <span style="
                                background: ${purchase.method === 'PayPal' ? 'linear-gradient(45deg, #0070ba, #003087)' : 'linear-gradient(45deg, #22c55e, #16a34a)'};
                                color: white;
                                padding: 2px 8px;
                                border-radius: 12px;
                                font-size: 0.8rem;
                                font-weight: 600;
                            ">${purchase.method}</span>
                            ${isNew ? '<span style="background: #ef4444; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.7rem; animation: pulse 1s infinite;">🆕 NUOVO</span>' : ''}
                        </div>
                        <div style="color: #94a3b8; font-size: 0.9rem;">
                            Numeri: <span style="color: #fbbf24; font-weight: 600;">${purchase.numbers.join(', ')}</span>
                        </div>
                        <div style="color: #94a3b8; font-size: 0.8rem; margin-top: 3px;">
                            ${new Date(purchase.timestamp).toLocaleString('it-IT')}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: #10b981;">€${purchase.total}</div>
                        <div style="font-size: 0.8rem; color: #94a3b8;">${purchase.numbers.length} numero${purchase.numbers.length > 1 ? 'i' : ''}</div>
                    </div>
                `;
                
                // Effetto evidenziazione per nuovi acquisti
                if (isNew) {
                    item.style.background = 'linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.05))';
                    item.style.border = '2px solid rgba(34, 197, 94, 0.3)';
                    item.style.boxShadow = '0 8px 25px rgba(34, 197, 94, 0.2)';
                }
                
                container.appendChild(item);
            });
            
            // Aggiungi statistiche totali
            const totalContainer = document.createElement('div');
            totalContainer.style.cssText = `
                margin-top: 20px;
                padding: 15px;
                background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(200,16,46,0.1));
                border-radius: 10px;
                border: 1px solid rgba(255,215,0,0.2);
                text-align: center;
            `;
            
            const totalRevenue = allPurchases.reduce((sum, p) => sum + p.total, 0);
            const totalNumbers = allPurchases.reduce((sum, p) => sum + p.numbers.length, 0);
            
            totalContainer.innerHTML = `
                <div style="display: flex; justify-content: space-around; color: #ffd700;">
                    <div><strong>${allPurchases.length}</strong><br><small>Acquisti</small></div>
                    <div><strong>${totalNumbers}</strong><br><small>Numeri venduti</small></div>
                    <div><strong>€${totalRevenue}</strong><br><small>Incasso totale</small></div>
                </div>
            `;
            
            container.appendChild(totalContainer);
        }
        
        function startCountdown() {
            const targetDate = new Date('2025-12-24T18:30:00');
            const timerEl = document.getElementById('countdownTimer');
            
            function updateCountdown() {
                const now = new Date();
                const diff = targetDate - now;
                
                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    timerEl.textContent = `⏰ ${days}g ${hours}h ${minutes}m ${seconds}s all'estrazione`;
                } else {
                    timerEl.textContent = '🎉 ESTRAZIONE COMPLETATA!';
                }
            }
            
            updateCountdown();
            setInterval(updateCountdown, 1000);
        }
        
        // Toast notifications
        function showToast(message, type = 'info', duration = 4000) {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, duration);
        }
        
        // Gestione return da PayPal
        function handlePayPalReturn() {
            const urlParams = new URLSearchParams(window.location.search);
            
            if (urlParams.has('lottery')) {
                const status = urlParams.get('lottery');
                const paymentData = safeLocalStorage.get('lotteryPaymentData');
                
                if (status === 'success' && paymentData) {
                    try {
                        const data = JSON.parse(paymentData);
                        
                        // Salva acquisto localmente
                        const purchaseRecord = {
                            numbers: data.numbers,
                            buyerName: data.buyer.name,
                            timestamp: data.timestamp,
                            method: 'PayPal',
                            total: data.total
                        };
                        
                        // Prova Firebase se disponibile
                        if (window.savePurchaseToFirebase && typeof window.savePurchaseToFirebase === 'function') {
                            window.savePurchaseToFirebase(purchaseRecord);
                        } else if (window.savePurchaseLocally && typeof window.savePurchaseLocally === 'function') {
                            window.savePurchaseLocally(purchaseRecord);
                        }
                        
                        showToast(`🎄 Pagamento completato! Numeri: ${data.numbers.join(', ')}`, 'success', 8000);
                        
                        // Reset
                        selectedNumbers = [];
                        safeLocalStorage.remove('lotteryPaymentData');
                        
                        // Pulisci URL
                        window.history.replaceState({}, document.title, window.location.pathname);
                        
                        updateUI();
                        updatePurchasesList();
                        
                    } catch (error) {
                        console.error('❌ Errore processing return:', error);
                        showToast('Errore nella conferma del pagamento', 'error');
                    }
                    
                } else if (status === 'cancelled') {
                    showToast('Pagamento annullato', 'info');
                    safeLocalStorage.remove('lotteryPaymentData');
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }
        }
        
        console.log('🎄 Lotteria Natale 2025 pronta!');
        
        // Debug: Verifica funzioni critiche
        window.addEventListener('load', () => {
            console.log('✅ Funzioni caricate:', {
                getSoldNumbers: typeof getSoldNumbers,
                updateUI: typeof updateUI,
                updateCounters: typeof updateCounters,
                selectNumber: typeof selectNumber
            });
            
            // Forza inizializzazione se non è già stata fatta
            setTimeout(() => {
                const grid = document.getElementById('numbersGrid');
                const purchases = document.getElementById('purchasesList');
                
                if (grid && grid.innerHTML.trim() === '') {
                    console.log('⚠️ Griglia vuota, forzando inizializzazione...');
                    generateNumbersGrid();
                    updateUI();
                }
                
                if (purchases && purchases.innerHTML.trim() === '') {
                    console.log('⚠️ Lista acquisti vuota, forzando aggiornamento...');
                    updatePurchasesList();
                }
            }, 2000);
        });

        // === SISTEMA ESTRAZIONE AUTOMATICA ===
        
        // Date e orari per l'estrazione
        const CHIUSURA_VENDITE = new Date('2025-12-24T18:00:00');
        const ESTRAZIONE = new Date('2025-12-24T18:30:00');
        
        // Funzione principale di gestione countdown
        function updateCountdownSystem() {
            const now = new Date();
            
            const countdownVendite = document.getElementById('countdown-vendite');
            const countdownEstrazione = document.getElementById('countdown-estrazione');
            const estrazioneLive = document.getElementById('estrazione-live');
            
            // ESTRAZIONE CONCLUSA - Mostra sempre i risultati finali
            console.log('🏆 LOTTERIA CONCLUSA - Mostrando risultati dell\'estrazione del 24 Dicembre 2025');
            
            countdownVendite.style.display = 'none';
            countdownEstrazione.style.display = 'none';
            estrazioneLive.style.display = 'block';
            
            // Disabilita definitivamente le vendite
            enableVendite(false);
            
            // Mostra automaticamente i risultati
            mostraRisultatiFinali();
        }
        
        // Aggiorna countdown vendite
        function updateCountdownVendite(now) {
            const timeLeft = CHIUSURA_VENDITE.getTime() - now.getTime();
            
            if (timeLeft <= 0) {
                updateCountdownSystem();
                return;
            }
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('hours').textContent = String(hours).padStart(2, '0');
            document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            
            // Aggiorna messaggio di urgenza
            const alertDiv = document.getElementById('vendite-alert');
            if (hours < 2) {
                alertDiv.innerHTML = '<span style="color: #ff6b6b; font-size: 1.1rem; font-weight: 600; animation: pulse 1s infinite;">🚨 ULTIME ORE! Non perdere l\'occasione!</span>';
            } else if (hours < 6) {
                alertDiv.innerHTML = '<span style="color: #ffd700; font-size: 1.1rem; font-weight: 600;">⚡ Poche ore rimaste per partecipare!</span>';
            }
        }
        
        // Aggiorna countdown estrazione
        function updateCountdownEstrazione(now) {
            const timeLeft = ESTRAZIONE.getTime() - now.getTime();
            
            if (timeLeft <= 0) {
                updateCountdownSystem();
                return;
            }
            
            const minutes = Math.floor(timeLeft / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('minutes-est').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds-est').textContent = String(seconds).padStart(2, '0');
        }
        
        // Abilita/disabilita vendite
        function enableVendite(enabled) {
            const buyButtons = document.querySelectorAll('.buy-btn, .btn-premium');
            buyButtons.forEach(btn => {
                btn.disabled = true;
                btn.style.background = '#666';
                btn.style.cursor = 'not-allowed';
                btn.style.opacity = '0.4';
                if (btn.textContent.includes('Acquista') || btn.textContent.includes('PayPal')) {
                    btn.textContent = '🚫 LOTTERIA CONCLUSA';
                }
            });
            
            console.log('🔒 Tutte le vendite definitivamente bloccate - Lotteria conclusa');
        }
        
        // === CALCOLO VINCITORI ===
        
        function calcolaVincitori() {
            const numero1 = parseInt(document.getElementById('numero1').value);
            const numero2 = parseInt(document.getElementById('numero2').value);
            const numero3 = parseInt(document.getElementById('numero3').value);
            
            // Validazione input
            if (!numero1 || !numero2 || !numero3 || 
                numero1 < 1 || numero1 > 90 ||
                numero2 < 1 || numero2 > 90 ||
                numero3 < 1 || numero3 > 90) {
                alert('❌ Inserisci tutti i primi 3 numeri estratti del Lotto (1-90)!');
                return;
            }
            
            // Mappatura DIRETTA: 1° numero lotto = 1° premio, ecc.
            const numeriVincenti = {
                primo: numero1,
                secondo: numero2, 
                terzo: numero3
            };
            
            console.log('🎲 Numeri estratti Lotto Genova:', { numero1, numero2, numero3 });
            console.log('🏆 Numeri vincenti lotteria:', numeriVincenti);
            
            // Cerca vincitori nel database acquisti
            const allPurchases = JSON.parse(localStorage.getItem('lotteryPurchases') || '[]');
            
            const vincitori = {
                primo: trovaVincitore(numeriVincenti.primo, allPurchases),
                secondo: trovaVincitore(numeriVincenti.secondo, allPurchases),
                terzo: trovaVincitore(numeriVincenti.terzo, allPurchases)
            };
            
            console.log('👥 Vincitori trovati:', vincitori);
            
            // Mostra risultati
            mostraRisultatiEstrazione(numeriVincenti, vincitori);
        }
        
        // Trova vincitore per numero specifico
        function trovaVincitore(numeroVincente, allPurchases) {
            for (let purchase of allPurchases) {
                if (purchase.numbers.includes(numeroVincente)) {
                    return {
                        numero: numeroVincente,
                        nome: purchase.name,
                        telefono: purchase.phone,
                        email: purchase.email
                    };
                }
            }
            return {
                numero: numeroVincente,
                nome: 'Numero non venduto',
                telefono: '',
                email: ''
            };
        }
        
        // Mostra risultati estrazione
        function mostraRisultatiEstrazione(numeriVincenti, vincitori) {
            // Aggiorna i numeri vincenti
            document.getElementById('numero-vincente-1').textContent = numeriVincenti.primo;
            document.getElementById('numero-vincente-2').textContent = numeriVincenti.secondo;
            document.getElementById('numero-vincente-3').textContent = numeriVincenti.terzo;
            
            // Aggiorna i nomi vincitori
            document.getElementById('nome-vincitore-1').textContent = vincitori.primo.nome;
            document.getElementById('nome-vincitore-2').textContent = vincitori.secondo.nome;
            document.getElementById('nome-vincitore-3').textContent = vincitori.terzo.nome;
            
            // Aggiorna timestamp
            const now = new Date();
            document.getElementById('data-estrazione').textContent = now.toLocaleString('it-IT');
            
            // Mostra sezione risultati con animazione
            const risultatiDiv = document.getElementById('risultati-estrazione');
            risultatiDiv.style.display = 'block';
            
            // Salva risultati nel localStorage
            const risultati = {
                dataEstrazione: now.toISOString(),
                numeriLotto: [document.getElementById('numero1').value, 
                            document.getElementById('numero2').value,
                            document.getElementById('numero3').value],
                numeriVincenti,
                vincitori,
                certificato: true
            };
            
            localStorage.setItem('lotteryResults', JSON.stringify(risultati));
            
            console.log('✅ Risultati salvati:', risultati);
            
            // Scroll automatico ai risultati
            risultatiDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Effetto confetti (opzionale)
            celebrateWinners();
        }
        
        // Effetto celebrazione vincitori
        function celebrateWinners() {
            // Semplice animazione di celebrazione
            const vincitoreCards = document.querySelectorAll('.vincitore-card');
            vincitoreCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.animation = 'pulse 0.6s ease-in-out';
                    setTimeout(() => {
                        card.style.animation = '';
                    }, 600);
                }, index * 200);
            });
        }
        
        // === MOSTRA RISULTATI FINALI ===
        function mostraRisultatiFinali() {
            console.log('🏆 Caricamento risultati finali dell\'estrazione...');
            
            // Nasconde la sezione di preparazione se visibile
            const preparazione = document.getElementById('preparazione-estrazione');
            if (preparazione) {
                preparazione.style.display = 'none';
            }
            
            // Assicura che i risultati siano visibili
            const risultatiDiv = document.getElementById('risultati-estrazione');
            if (risultatiDiv) {
                risultatiDiv.style.display = 'block';
            }
            
            // Salva i risultati finali nel localStorage
            const risultatiFinali = {
                dataEstrazione: '2025-12-24T18:30:00',
                numeriLotto: ['20', '44', '89'],
                numeriVincenti: {
                    primo: 20,
                    secondo: 44,
                    terzo: 89
                },
                vincitori: {
                    primo: { numero: 20, nome: 'ALYSEA', metodo: 'Contanti' },
                    secondo: { numero: 44, nome: 'Numero non venduto', metodo: '' },
                    terzo: { numero: 89, nome: 'LAURA BRUNO', metodo: 'Contanti' }
                },
                certificato: true,
                conclusa: true
            };
            
            localStorage.setItem('lotteryResults', JSON.stringify(risultatiFinali));
            console.log('✅ Risultati finali salvati nel localStorage');
        }
        // === INIZIALIZZAZIONE SISTEMA ===
        
        // Avvia il sistema di countdown
        updateCountdownSystem();
        setInterval(updateCountdownSystem, 1000);
        
        // Test rapido (rimuovere in produzione)
        console.log('🎄 Sistema Estrazione Lotteria inizializzato!');
        console.log('⏰ Chiusura vendite:', CHIUSURA_VENDITE.toLocaleString('it-IT'));
        console.log('🎲 Estrazione:', ESTRAZIONE.toLocaleString('it-IT'));
        
        // Debug: Per testare in locale, decommentare le righe seguenti
        // CHIUSURA_VENDITE = new Date(Date.now() + 10000); // 10 secondi da ora
        // ESTRAZIONE = new Date(Date.now() + 20000); // 20 secondi da ora
    </script>
</body>
</html>